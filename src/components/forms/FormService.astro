---
import "./form.css";
import InputText from "./InputText.astro";
import Select from "./Select.astro";
import Textarea from "./Textarea.astro";
import InputPhone from "./InputPhone.astro";

import getServises from "@data/getServices";

import useTranslations from "@i18n/translation";
import { getLangFromUrl } from "@i18n/utils";

const ui = {
  en: {
    "text.success": "Great! <br> We have received your application and <br>will contact you soon",
    "block1.title": "How to contact you",
    "block1.input1": "Name",
    "block1.input2": "Last Name",
    "block2.title": "Service of interest",
    "block3.title": "Contacts",
    "block3.input1": "Phone number",
    "block3.input2": "Email",
    "block4.title": "Comment",
    "block4.input1": "Write something as needed",
    "text.sign": "by submitting your application, you agree to",
    "text.privacy": "privacy policy",
    "text.button": "Submit request",
  },
  ru: {
    "text.success": "Отлично! <br> Мы получили заявку и <br>скоро свяжемся с вами",
    "block1.title": "Как к вам обращаться",
    "block1.input1": "Имя",
    "block1.input2": "Фамилия",
    "block2.title": "Интересующая услуга",
    "block3.title": "Контакты",
    "block3.input1": "Номер телефона",
    "block3.input2": "Электронная почта",
    "block4.title": "Комментарий",
    "block4.input1": "Напишите что–то по необходимости",
    "text.sign": "отправляя заявку, вы соглашаетесь с",
    "text.privacy": "политикой конфиденциальности",
    "text.button": "Отправить заявку",
  },
} as const;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang, ui);

const services = await getServises(lang);
---

<script src="./form.ts"></script>

<astro-form>
  <form
    class="form"
    action=`${import.meta.env.PUBLIC_STRAPI_URL}/api/order-services`
    data-text-sucсess={t("text.success")}
  >
    <div class="form-body">
      <div class="form-block">
        <div class="form-blok-title">{t("block1.title")}</div>
        <div class="form-row">
          <InputText type="text" name="name" placeholder={t("block1.input1")} required />
          <InputText type="text" name="lastname" placeholder={t("block1.input2")} />
        </div>
      </div>
      <div class="form-block">
        <div class="form-blok-title">{t("block2.title")}</div>
        <div class="form-row">
          <Select id={2} name="service" list={services} />
        </div>
      </div>
      <div class="form-block">
        <div class="form-blok-title">{t("block3.title")}</div>
        <div class="form-row">
          <InputPhone name="phone" placeholder={t("block3.input1")} required />
          <InputText
            type="email"
            name="email"
            placeholder={t("block3.input2")}
          />
        </div>
      </div>
      <div class="form-block">
        <div class="form-blok-title">{t("block4.title")}</div>
        <div class="form-row">
          <Textarea
            name="comment"
            placeholder={t("block4.input1")}
          />
        </div>
      </div>
      <p>{t("text.sign")} <a class="form-link link" target="_blank" href="/pdf/ПТС%20(Политика%20кофиденциальности).pdf">{t("text.privacy")}</a></p>
      <button type="submit" class="btn form-submit">{t("text.button")}</button>
    </div>
  </form>
</astro-form>

---
interface Props {
  breadcrumbs: Array<Crumb>;
}

interface Crumb {
  title: string;
  href?: string;
}

const { breadcrumbs } = Astro.props;
---

<script>
  const container: HTMLElement | null =
    document.querySelector(".crumbs-container");
  const chr: HTMLElement | null = document.querySelector(".crumbs-hr");

  const containerHeight:number = container.getBoundingClientRect().height;

  window.addEventListener("scroll", () => {
    const thr: number = chr.getBoundingClientRect().top;

    if (thr <= containerHeight) {
      container.classList.add("crumbs-container--fixed");
      (chr as HTMLElement).style.marginBottom = `${containerHeight}px`;
    } else {
      container.classList.remove("crumbs-container--fixed");
      (chr as HTMLElement).style.marginBottom = "0";
    }
  });
</script>

<div class="crumbs-hr"></div>
<div class="crumbs-container">
  <div class="crumbs-wrapper">
    <ul class="crumbs">
      {
        breadcrumbs.map((item: Crumb) => (
          <li class="crumbs-item">
            {item.href && (
              <a class="link" href={item.href}>
                {item.title}
              </a>
              <div set:html="/" class="crumbs-item-sign" />
            )}
  
            {!item.href && <span class="crumbs-item-current">{item.title}</span>}
          </li>
        ))
      }
    </ul>
  </div>
</div>

<style>
  .crumbs-container {
    display: none;
  }

  .crumbs-container {
    height: 56px;
    background-color: #faf8f8;
  }

  .crumbs-container--fixed {
    position: fixed;
    top: 56px;
    width: calc(100% - 64px);
    z-index: 10;
  }

  .crumbs-wrapper {
    position: relative;
  }

  .crumbs-wrapper::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 1px;
    background-color: #161619;
  }

  .crumbs-wrapper::before {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 1px;
    background-color: #161619;
  }

  .crumbs {
    position: relative;
    margin: 0;
    padding: 0;
    display: flex;
    align-items: center;
  }

  .crumbs::after {
    content: "";
    position: absolute;
    top: 0;
    left: -32px;
    width: calc(100% + 64px);
    height: 100%;
    background-color: #faf8f8;
    z-index: -1;
  }

  .crumbs-item {
    list-style: none;
    max-width: 452px;
    display: flex;
  }

  .crumbs-item-sign {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 56px;
    padding: 0 8px;
  }

  .crumbs-item > * {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }

  .crumbs-item-current {
    color: #fe5639;
    cursor: default;
  }

  @media screen and (min-width: 1025px) {
    .crumbs-container {
      display: block;
    }
  }

  @media screen and (min-width: 1921px) {
    .crumbs-container {
      height: 7vh;
    }

    .crumbs-container--fixed {
      top: 7vh;
      width: calc(100% - 8vw);
    }

    .crumbs::after {
      left: -4vw;
      width: calc(100% + 8vw);
    }

    .crumbs-item {
      max-width: 56vw;
    }

    .crumbs-item-sign {
      height: 7vh;
      padding: 0 1vw;
    }
  }
</style>
